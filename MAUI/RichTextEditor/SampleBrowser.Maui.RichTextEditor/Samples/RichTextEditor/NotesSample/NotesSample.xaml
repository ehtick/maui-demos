<?xml version="1.0" encoding="UTF-8"?>
<localCore:SampleView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
                      xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                      xmlns:localCore="clr-namespace:SampleBrowser.Maui.Base;assembly=SampleBrowser.Maui.Base"
                      xmlns:popup="clr-namespace:Syncfusion.Maui.Popup;assembly=Syncfusion.Maui.Popup"
                      xmlns:button="clr-namespace:Syncfusion.Maui.Buttons;assembly=Syncfusion.Maui.Buttons"
                      xmlns:core="clr-namespace:Syncfusion.Maui.Core;assembly=Syncfusion.Maui.Core"
                      xmlns:rte="clr-namespace:Syncfusion.Maui.RichTextEditor;assembly=Syncfusion.Maui.RichTextEditor"
                      xmlns:toolbar="clr-namespace:Syncfusion.Maui.Toolbar;assembly=Syncfusion.Maui.Toolbar"
                      xmlns:inputs="clr-namespace:Syncfusion.Maui.Inputs;assembly=Syncfusion.Maui.Inputs"
                      xmlns:local="clr-namespace:SampleBrowser.Maui.RichTextEditor.RichTextEditor"
                      x:Class="SampleBrowser.Maui.RichTextEditor.RichTextEditor.NotesSample"
                      BackgroundColor="{AppThemeBinding Light={StaticResource BackgroundLight},
                                      Dark={StaticResource BackgroundDark}}">

    <localCore:SampleView.BindingContext>
        <local:NotesViewModel />
    </localCore:SampleView.BindingContext>

    <localCore:SampleView.Resources>
        <ResourceDictionary>
            <local:InverseBooleanConverter x:Key="InverseBooleanConverter" />

            <local:TextToVisibilityConverter x:Key="TextToVisibilityConverter" />

            <Style x:Key="ButtonStyle"
                   TargetType="Button">
                <Setter Property="FontSize"
                        Value="26" />
                <Setter Property="TextColor"
                        Value="{AppThemeBinding Light={StaticResource BackgroundDark},
                                      Dark={StaticResource BackgroundLight}}" />
                <Setter Property="BackgroundColor"
                        Value="Transparent" />
                <Setter Property="BorderColor"
                        Value="Transparent" />
                <Setter Property="BorderWidth"
                        Value="0" />
                <Setter Property="FontFamily"
                        Value="MauiSampleFontIcon" />
                <Setter Property="CornerRadius"
                        Value="50" />
            </Style>

            <Style x:Key="StarButtonStyle"
                   TargetType="Button">
                <Setter Property="FontSize"
                        Value="24" />
                <Setter Property="TextColor"
                        Value="{AppThemeBinding Light=#FFA500, Dark=#FFD700}" />
                <Setter Property="BackgroundColor"
                        Value="Transparent" />
                <Setter Property="BorderColor"
                        Value="Transparent" />
                <Setter Property="BorderWidth"
                        Value="0" />
                <Setter Property="CornerRadius"
                        Value="50" />
            </Style>
        </ResourceDictionary>
    </localCore:SampleView.Resources>

    <Grid RowDefinitions="Auto, *">
        <Grid.Padding>
            <OnPlatform x:TypeArguments="Thickness">
                <On Platform="Android, iOS"
                    Value="15" />
                <On Platform="WinUI, MacCatalyst"
                    Value="0,7" />
            </OnPlatform>
        </Grid.Padding>

        <Grid IsVisible="{Binding IsHomePage, Converter={StaticResource InverseBooleanConverter}}"
              ColumnDefinitions="Auto,*,Auto,Auto"
              ColumnSpacing="10">
            <!--Back / add button-->
            <Button Text="&#xE70E;"
                    Padding="0"
                    Style="{StaticResource ButtonStyle}"
                    Command="{Binding AddNoteCommand}">
                <Button.CommandParameter>
                    <local:ButtonCommandParameter Reference1="{x:Reference NoteTitleEntry}"
                                                  Reference2="{x:Reference NoteContentRTE}" />
                </Button.CommandParameter>
            </Button>

            <!--Star button-->
            <button:SfButton Grid.Column="2" HeightRequest="40" WidthRequest="40"  Background="Transparent"
                    Command="{Binding StarCommand}" FontFamily="MauiSampleFontIcon"
                    EnableRippleEffect="False"
                    IsVisible="{Binding SelectedNote, Converter={StaticResource TextToVisibilityConverter}}" >
                <button:SfButton.Content>
                <DataTemplate>
                <inputs:SfRating InputTransparent="True" Precision="Standard" ItemCount="1" ItemSize="20"  Value="{Binding SelectedNote.StarValue}">
                <inputs:SfRating.RatingSettings>
                <inputs:RatingSettings UnratedStrokeThickness="1" UnratedFill="Transparent" 
                    RatedFill="{AppThemeBinding Light=#FFA500, Dark=#FFD700}"                                                
                    RatedStroke="{AppThemeBinding Light=#FFA500, Dark=#FFD700}" 
                    UnratedStroke="{AppThemeBinding Light=#FFA500, Dark=#FFD700}"/>
                </inputs:SfRating.RatingSettings>
                </inputs:SfRating>
                </DataTemplate>
                </button:SfButton.Content>
                </button:SfButton>
    
            <!--<Button Grid.Column="3"
                    Text="&#xe74c;"
                    Style="{StaticResource ButtonStyle}" />-->
        </Grid>

        <CollectionView x:Name="collectionView"
                        Grid.Row="1"
                        IsVisible="{Binding IsHomePage}"
                        ItemsSource="{Binding GroupedNotes}"
                        IsGrouped="True"
                        EmptyView="No notes!"
                        SelectionMode="None">
            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical" 
                                 Span="{OnPlatform Default=2, Android=2, iOS=2, WinUI=3}"
                                 HorizontalItemSpacing="10"
                                 VerticalItemSpacing="4"
                                 />
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="local:NoteModel">
                    <local:Item />
                </DataTemplate>
            </CollectionView.ItemTemplate>

            <CollectionView.GroupHeaderTemplate>
                <DataTemplate>
                    <Label Text="{Binding Key}"
                           TextColor="{AppThemeBinding Light=Black,  Dark=White}"
                           FontAttributes="Bold"
                           Margin="0,12,0,4" />
                </DataTemplate>
            </CollectionView.GroupHeaderTemplate>
        </CollectionView>

        <!--Flotting Button-->
        <button:SfButton Grid.Row="1"
                         Text="&#xE73D;"
                         FontFamily="MauiSampleFontIcon"
                         Command="{Binding ShowAddNotePopupCommand}"
                         CornerRadius="28"
                         FontSize="24"
                         FontAttributes="Bold"
                         WidthRequest="56"
                         HeightRequest="56"
                         HorizontalOptions="End"
                         VerticalOptions="End"
                         IsVisible="{Binding IsHomePage}" />

        <!--Editor view-->
        <Grid Grid.Row="1"
              IsVisible="{Binding IsHomePage, Converter={StaticResource InverseBooleanConverter}}"
              RowDefinitions="Auto,*"
              RowSpacing="10">

            <local:BorderlessEntry x:Name="NoteTitleEntry"
                                   FontSize="22"
                                   FontAttributes="Bold"
                                   Placeholder="Title"
                                   Text="{Binding SelectedNoteTitle, Mode=TwoWay}"
                                   Margin="5, 0" />

            <rte:SfRichTextEditor Grid.Row="1"
                                  x:Name="NoteContentRTE"
                                  Placeholder="Note"
                                  PlaceholderFontSize="14"
                                  DefaultFontSize="12"
                                  ToolbarPosition="Bottom"
                                  BorderColor="Transparent"
                                  BorderThickness="0"
                                  HtmlText = "{Binding SelectedHtmlNoteContent}">
                <rte:SfRichTextEditor.ToolbarItems>
                    <rte:RichTextToolbarItem Type="Undo" />
                    <rte:RichTextToolbarItem Type="Redo" />
                    <rte:RichTextToolbarItem Type="Separator" />
                    <rte:RichTextToolbarItem Type="Bold" />
                    <rte:RichTextToolbarItem Type="Italic" />
                    <rte:RichTextToolbarItem Type="Underline" />
                    <rte:RichTextToolbarItem Type="Strikethrough" />
                    <rte:RichTextToolbarItem Type="Separator" />
                    <rte:RichTextToolbarItem Type="ParagraphFormat" />
                </rte:SfRichTextEditor.ToolbarItems>
            </rte:SfRichTextEditor>
        </Grid>
    </Grid>
</localCore:SampleView>